{% extends 'espace_membre/base_member.html.twig' %}

{% block title %}{{ parent() }} Détail Service client {% endblock %}

{% set menu_service_client = true %}

{% block body %}
    <div class="row">
        <div class="box-header col-md-6">
            <h3 class="box-title">Détail service client</h3>
        </div>
        <div class="box-footer col-md-6 kl-link-back">
            <a href="{{ url_referer }}"
               class="btn btn-default pull-right btn-mini-rectif" >
                <i class="fa fa-reply-all" aria-hidden="true"></i>Retour à la liste
            </a>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 kl-grey">
            <div class="box box-primary">
                <div class="box-body">
                    {# Client #}
                    <div class="alert alert-warning">
                        <h4>Informations client</h4>
                    </div>
                    <div class="form-group">
                        <label>Nom client</label>
                        {{ service_client.lvUser.usrFullname }}
                    </div>
                    <div class="form-group">
                        <label>Nom entreprise</label>
                        {{ service_client.lvUser.usrNomEntreprise }}
                    </div>
                    <div class="form-group">
                        <label>Email client</label>
                        <a href="mailto:{{ service_client.lvUser.email }}" title="Envoyer mail">
                            {{ service_client.lvUser.email }}
                        </a>
                    </div>
                    <div class="form-group">
                        <label>Adresse client</label>
                        {{ service_client.lvUser.usrAddress }}
                    </div>
                    <div class="form-group">
                        <label>Téléphone client</label>
                        {{ service_client.lvUser.usrPhone }}
                    </div>
                    <hr>

                    {# Service #}
                    <div class="alert alert-warning">
                        <h4>Informations projet</h4>
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        {{ service_client.srvCltDate|date('d/m/Y H:i') }}
                    </div>
                    <div class="form-group">
                        <label>Lien du projet</label>
                        <a href="{{ service_client.srvCltProjectLink }}" title="Voir" target="_blank">
                            {{ service_client.srvCltProjectLink }}
                        </a>
                    </div>
                    <div class="form-group">
                        <label>Description du projet</label>
                        {{ service_client.srvCltDesc|nl2br }}
                    </div>
                    <div class="form-group">
                        <label>Service</label>
                        {{ service_client.lvService.srvLabel }}
                    </div>
                    <div class="form-group">
                        <label>Nombre de page à intégrer</label>
                        {{ service_client.srvCltNbrPage }}
                    </div>
                    <div class="form-group">
                        <label>Nombre de page déclinées</label>
                        {{ service_client.srvCltNbrPageDecline }}
                    </div>
                    <div class="form-group">
                        <label>Prix service</label>
                        {{ service_client.lvService.srvPrix }} €
                    </div>
                    <div class="form-group">
                        <label>Réduction service</label>
                        {{ service_client.lvService.srvReduction }} %
                    </div>
                    <div class="form-group">
                        <label>Description service</label>
                        {{ service_client.lvService.srvDesc }}
                    </div>
                    <div class="form-group">
                        <label>Options services</label>
                        {% for service_option in service_client.lvServiceOptions %}
                            {{ service_option.srvOptLabel }}
                            ({{ service_option.serviceValeurString }})
                            {{ loop.last ? ' ' : ',' }}
                        {% endfor %}
                    </div>
                    <div class="form-group">
                        <label>Pièce jointe</label>
                        {% if service_client_jointes|length == 0 %}
                            Aucun
                        {% endif %}
                        {% for service_client_jointe in service_client_jointes %}
                            {% if service_client_jointe and file_exists(web_path ~ service_client_jointe.srvCltJtPath) %}
                                <a href="{{ service_client_jointe.srvCltJtPath }}" title="Téléchargez" target="_blank">
                                    {{ service_client_jointe.srvCltJtPath[15:] }}
                                </a>
                                {{ loop.last ? ' ' : ',' }}
                            {% endif %}
                        {% endfor %}
                    </div>
                    {% if service_client.srvCltStatusValidation == 6 %}
                        <div class="form-group">
                            <label>Lien de visualisation</label>
                            <a href="{{ service_client.srvCltLienLivre }}" title="Voir" target="_blank">
                                Voir
                            </a>
                        </div>
                    {% endif %}
                    {% if service_client.srvCltStatusValidation == 7 %}
                        <div class="kl-download-source">
                            <a target="_blank" href="{{ service_client.srvCltLienCodeSource }}"
                               class="btn btn-default btn-mini-rectif">
                                <i class="fa fa-download" aria-hidden="true"></i>Télécharger code source
                            </a>
                        </div>
                    {% endif %}
                    <hr>

                    {# Paiement #}
                    <div class="alert alert-warning">
                        <h4>Informations paiement</h4>
                    </div>
                    <div class="form-group">
                        <label>Total prix</label>
                        {{ service_client.srvCltPrix }} €
                    </div>
                    <div class="form-group">
                        <label>Statut paiement</label>
                        {% if service_client.srvCltIsPayed %}
                            Payé
                            {% if service_client.srvCltPaymentIsFacture %}
                                et facturé
                                <a href="{{ service_client.factureUrl }}" title="Voir" target="_blank">
                                    Voir
                                </a>
                            {% else %}
                                et n'est pas encore facturé
                            {% endif %}
                        {% else %}
                            Non payé
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}